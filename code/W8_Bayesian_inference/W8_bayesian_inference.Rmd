---
title: "Bayesian Inference"
author: "Zihang"
date: "2024-04-09"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

1. Use my priors as described below to determine the posterior probability that enough barley is being
added to each pint.
##  先验概率 两大假设
P(H1) = P(enough barley) = 0.5
P(H2) = P(not enough barley) = 0.5
##  给定数据的条件概率
P(DATA|H1) = P(mean barley content 46g|enough barley) = 0.7
P(DATA|H2) = P(mean barley content 46g|not enough barley) = 0.4
What is the Bayes Factor for these two hypotheses?

## Bayes Factor
BF= P(DATA∣H2)/P(DATA∣H1)


```{r }
Pdata_H1=0.7
Pdata_H2=0.4
BF=Pdata_H1/Pdata_H2

```


2. Lets explore the probability of seeing the data given each of the two hypotheses. The numbers given
here are estimates based on experience. To see how they influence the Bayes factor, calculate the Bayes
Factor for each combination of P(DATA|H1)and P(DATA|H2) from 0 to 1 in steps of 0.1 Please plot
these on a graph where these two probabilities are the x and y axes.

```{r}

library(ggplot2)

# 创建数据框
df <- expand.grid(Pdata_H1 = seq(0.1, 1, by = 0.1),
                  Pdata_H2 = seq(0.1, 1, by = 0.1))

# 计算颜色填充值
df$fill_value <- df$Pdata_H1 / df$Pdata_H2

# 绘制热图
ggplot(df) +
  aes(x = Pdata_H1, y = Pdata_H2, fill = fill_value)+
  scale_fill_gradient(low = "white", high = "red", name = "Pdata_H1/Pdata_H2")+
  egg::theme_article() +
  geom_tile()  +
  labs(x = "P(DATA|H1)",
       y = "P(DATA|H2)")

```


3. Now, I think that my staff are stealing barley to make their own moonshine Guiness at home. I update
my first prior to P(A) = P(enough barley) = 0.2. How does this affect the Bayes Factor? How does it
affect the posteriors?

P(DATA)=P(DATA∣H1)×P(H1)+P(DATA∣H2)×P(H2)

```{r}
P_data=0.7*0.5+0.4*0.5 ##0.55

```
A dice game
You play a dice-based game with a friend online, using six-sided dice. In this game, rolling a six is especially
lucky and wins you many points.
Since you are playing via video link, your friend uses their own die. You can see that it is six-sided, but you
cannot see the numbers clearly.
Over the course of the game, your friend rolls the dice 20 times, and 7 out of those 20 rolls are sixes.
Do you think your friend is playing fair? How many sixes do you believe their die has? 1 (like a normal
die)? Or more (the die is unfair)?
How? Before you start coding, think about this for a moment. The main idea is you have 6 possible
hypotheses, one for each number of sixes. Is it really 6 though? Also, how do you compare these hypothesis?
Do you have to compare every hypothesis with every other?
```{r}

```



